# 🚀 职称评审材料交叉检验系统 - 环境配置终极指南

## 📋 第一步：系统要求检查

### 操作系统支持
- ✅ **Windows 10/11** (推荐)
- ✅ **macOS 10.15+**
- ✅ **Ubuntu 18.04+**

### 必需软件
- 🐍 **Python 3.11** (项目指定版本)
- 💻 **命令行终端** (CMD/PowerShell/Terminal)

## 🔧 第二步：Python环境设置

### 下载安装Python
1. 访问 [Python官网](https://www.python.org/downloads/)
2. 下载Python 3.11版本
3. 安装时**务必勾选**"Add Python to PATH"

### 验证安装
```bash
# 检查Python版本
python --version
# 应显示: Python 3.11.x

# 检查pip
pip --version
```

### 创建虚拟环境（推荐）
```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate
```

## 📦 第三步：安装项目依赖

### 安装核心依赖
```bash
# 进入项目目录
cd gemini_langchain_checker

# 安装所有依赖
pip install -r requirements.txt
```

### 依赖包清单
- 🤖 **google-genai>=0.7.0** - Gemini AI接口
- 🌐 **flask** - Web框架
- 📄 **pypdf** - PDF处理
- 📊 **pandas, openpyxl** - 数据处理
- 🔧 **python-dotenv** - 环境变量管理
- 🔄 **celery, redis** - 异步队列系统
- 📈 **psutil** - 系统监控

## 🔑 第四步：API密钥配置

### 获取Google API密钥
1. 访问 [Google AI Studio](https://aistudio.google.com/)
2. 创建新的API密钥
3. 复制密钥备用

### 创建.env配置文件
在项目根目录创建`.env`文件：

```env
# 🔑 Google API配置（必需）
# 方式1：单个密钥
GOOGLE_API_KEY=your_api_key_here

# 方式2：多个密钥（推荐，提高并发性能）
GOOGLE_API_KEYS=key1,key2,key3

# 方式3：分别配置
# GOOGLE_API_KEY_2=your_second_api_key
# GOOGLE_API_KEY_3=your_third_api_key

# 📊 数据库配置（可选）
DATABASE_PATH=./database.db

# 💾 缓存配置（可选）
CACHE_DIR=./cache
CACHE_MAX_AGE_HOURS=24
CACHE_MAX_MEMORY_ITEMS=100
CACHE_MAX_DISK_SIZE_MB=1000

# 🔄 Redis缓存配置（可选）
REDIS_URL=redis://localhost:6379/0

# 🌐 Flask配置（可选）
SECRET_KEY=your_secret_key_here
FLASK_ENV=production
```

## 🗄️ 第五步：数据库初始化

### 自动初始化
```bash
# 运行设置脚本
python setup.py
```

### 手动初始化
```bash
# 初始化数据库
python manage_database.py init

# 验证数据库
python manage_database.py stats
```

## 🚀 第六步：启动系统

### 快速启动（推荐）
```bash
# Windows用户：
start.bat

# 或直接运行：
python start_server.py
```

### 手动启动
```bash
# 标准启动
python app.py

# 增强启动（自动端口检测）
python start_server.py
```

## 🌐 第七步：访问系统

### 本地访问
- 🏠 **主页**: http://127.0.0.1:5000
- 📊 **历史记录**: http://127.0.0.1:5000/history
- 📈 **系统状态**: http://127.0.0.1:5000/status

### 局域网访问
- 🌍 **局域网**: http://你的IP地址:5000
- 例如: http://192.168.1.100:5000

## ⚙️ 第八步：高级配置（可选）

### Redis缓存配置
```bash
# 安装Redis (Windows用户可选)
# 下载: https://github.com/tporadowski/redis/releases

# 启动Redis
redis-server

# 测试Redis
redis-cli ping
```

### 防火墙配置 (Windows)
```bash
# 运行防火墙设置脚本
setup_firewall.bat
```

### 异步队列系统
```bash
# 启动Celery工作进程
start_celery.bat

# 或手动启动
python start_worker.py
```

## 🔍 第九步：验证安装

### 运行完整检查
```bash
python setup.py
```

### 检查清单
- ✅ Python 3.11已安装
- ✅ 所有依赖包已安装
- ✅ .env文件已配置
- ✅ API密钥有效
- ✅ 数据库已初始化
- ✅ 系统可正常启动
- ✅ Web界面可访问

## 🛠️ 故障排除

### 常见问题解决

#### 1. Python版本问题
```bash
# 检查Python版本
python --version

# 如果版本错误，重新安装Python 3.11
```

#### 2. 依赖安装失败
```bash
# 升级pip
pip install --upgrade pip

# 重新安装依赖
pip install -r requirements.txt
```

#### 3. API密钥无效
```bash
# 检查.env文件格式
# 确保没有多余空格
# 确保密钥正确复制
```

#### 4. 端口占用
```bash
# 检查端口使用情况
netstat -ano | findstr :5000

# 或使用自动端口检测
python start_server.py
```

#### 5. 权限问题
```bash
# Windows: 以管理员身份运行CMD
# macOS/Linux: 检查文件权限
chmod +x start_server.py
```

### 获取帮助
- 📖 查看项目文档目录的MD文件
- 🔧 运行 `python setup.py` 获取系统状态
- 📊 访问 `/status` 页面查看实时状态

## 🎯 快速启动命令汇总

```bash
# 一键式完整设置流程
git clone your_project_repo
cd gemini_langchain_checker
python -m venv venv
venv\Scripts\activate  # Windows
pip install -r requirements.txt
# 创建并配置.env文件
python setup.py
python start_server.py
```

## 📱 移动端访问

系统支持移动设备访问：
- 📱 响应式设计，自适应手机屏幕
- 🌐 通过局域网IP访问即可
- 📊 所有功能均支持移动端操作

## 🔒 安全提示

1. **API密钥安全**: 不要将.env文件提交到版本控制
2. **网络安全**: 生产环境建议配置HTTPS
3. **访问控制**: 可配置IP白名单限制访问
4. **数据备份**: 定期备份数据库文件

---

## ✅ 配置完成确认

当您看到以下界面时，说明配置成功：

```
🚀 职称评审材料交叉检验系统启动脚本
==================================================
📁 工作目录: d:\gemini_langchain_checker\gemini_langchain_checker
🌐 使用端口: 5000
📦 加载应用模块...
🔧 配置应用设置...
🌐 启动Web服务器...
   本地访问: http://127.0.0.1:5000
   局域网访问: http://0.0.0.0:5000
   按 Ctrl+C 停止服务器
==================================================
```

🎉 **恭喜！系统已成功配置并运行！**

现在您可以：
1. 📄 上传ZIP压缩包和Excel文件
2. 🔍 进行材料交叉验证分析
3. 📊 查看历史记录和报告
4. ⚙️ 监控系统运行状态

**学习要点总结**：
- 🐍 **Python环境管理**: 虚拟环境的创建和使用
- 📦 **依赖管理**: requirements.txt的作用和使用
- 🔑 **环境变量**: .env文件的配置和安全实践
- 🗄️ **数据库**: SQLite数据库的初始化和管理
- 🌐 **Web服务**: Flask应用的启动和配置
- 🔧 **故障排除**: 常见问题的诊断和解决方法